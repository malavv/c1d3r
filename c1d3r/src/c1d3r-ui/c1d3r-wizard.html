<link rel="import" href="../../bower_components/polymer/polymer.html">

<link rel="import" href="../../bower_components/iron-flex-layout/iron-flex-layout.html">
<link rel="import" href="../../bower_components/iron-pages/iron-pages.html">
<link rel="import" href="../../bower_components/paper-button/paper-button.html">

<link rel="import" href="c1d3r-desc.html">
<link rel="import" href="c1d3r-entry.html">
<link rel="import" href="c1d3r-final.html">
<link rel="import" href="c1d3r-progress.html">
<link rel="import" href="c1d3r-steps.html">

<link rel="import" href="../c1d3r-data/c1d3r-guide.html">
<link rel="import" href="../c1d3r-data/c1d3r-juice.html">

<dom-module id="c1d3r-wizard">
  <template>
    <style include="iron-flex iron-flex-factors"></style>

    <style>
      :host {
        @apply(--layout-vertical);
        background-color: rgb(242, 242, 242);
      }
      div.header {
        @apply(--layout-horizontal);
      }
      div.spacer {
        @apply(--layout-flex);
      }
      iron-pages {
        @apply(--layout-flex);
        @apply(--layout-vertical);
      }
      iron-pages > * {
        @apply(--layout-flex);
      }
      div.nav {
        @apply(--layout-horizontal);
        padding-bottom: 1em;
      }
    </style>

    <div class="header">
      <paper-button on-tap="navHome">C1D3R</paper-button>
      <div class="spacer"></div>
      <c1d3r-progress step="{{selected}}"></c1d3r-progress>
      <div class="spacer"></div>
    </div>

    <iron-pages selected="{{selected}}">
      <c1d3r-desc recipe="{{recipe}}"></c1d3r-desc>
      <c1d3r-entry recipe="{{recipe}}" data="{{data}}"></c1d3r-entry>
      <c1d3r-steps recipe="{{recipe}}" data="{{data}}" guide="{{guide}}"></c1d3r-steps>
      <c1d3r-final recipe="{{recipe}}" juice="{{juice}}" guide="{{guide}}"></c1d3r-final>
    </iron-pages>

    <div class="nav">
      <div class="flex"></div>
      <paper-button on-tap="navBack">Go Back</paper-button>
      <paper-button on-tap="navNext">[[_nextOrFinishStep(selected)]]</paper-button>
    </div>

    <!-- Data -->
    <c1d3r-juice data="{{data}}"></c1d3r-juice>
    <c1d3r-guide data="{{guide}}"></c1d3r-guide>
  </template>

  <script>
    Polymer({
      is: 'c1d3r-wizard',

      hostAttributes: {},

      properties: {
        selected: {
          type: Number,
          value: 0
        },
        recipe: {
          type: Object,
          notify: true
        },
        juice: {
          type: Object,
          notify: true
        }
      },

      navHome() { this.fire('home'); },

      navBack() {
        if (this.selected === 0) {
          this.fire('home');
          return;
        }
        this.set('selected', this.selected - 1);
      },

      navNext() {
        if (this.selected === 3) {
          this.fire('home');
          return;
        }
        this.set('selected', this.selected + 1);
      },

      onBlur() {
      },

      onFocus() {
        this.selected = 0;
      },

      _nextOrFinishStep(selected) {
        return selected === 3 ? 'Finish' : 'Next';
      }
    });
  </script>
</dom-module>
